<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Add constraints to a model Â· PiecewiseAffineApprox</title><meta name="title" content="Add constraints to a model Â· PiecewiseAffineApprox"/><meta property="og:title" content="Add constraints to a model Â· PiecewiseAffineApprox"/><meta property="twitter:title" content="Add constraints to a model Â· PiecewiseAffineApprox"/><meta name="description" content="Documentation for PiecewiseAffineApprox."/><meta property="og:description" content="Documentation for PiecewiseAffineApprox."/><meta property="twitter:description" content="Documentation for PiecewiseAffineApprox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PiecewiseAffineApprox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../approximate_function/">Approximate a function</a></li><li><a class="tocitem" href="../approximate_points/">Approximate points</a></li><li class="is-active"><a class="tocitem" href>Add constraints to a model</a></li><li><a class="tocitem" href="../plot_approximation/">Plot approximations</a></li></ul></li><li><a class="tocitem" href="../../background/background/">Background</a></li><li><a class="tocitem" href="../../reference/api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to</a></li><li class="is-active"><a href>Add constraints to a model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Add constraints to a model</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Add-approximation-to-model"><a class="docs-heading-anchor" href="#Add-approximation-to-model">Add approximation to model</a><a id="Add-approximation-to-model-1"></a><a class="docs-heading-anchor-permalink" href="#Add-approximation-to-model" title="Permalink"></a></h1><p>A piecewise-affine approximation Ìƒğ“ â‰ˆ ğ’»(ğ”) can be added to a JuMP model for optimization purposes. In that case, the optimization variables ğ” will denote the coordinates in the domain whereas the approximate value of function ğ’» will be represented by Ìƒğ“.</p><p>The code below creates a piecewise affine approximate to ğ“Â² on the interval [-1,1] using the JuMP variable ğ“. The piecewise affine approximation is linked the other variable in the model ğ“. The objective is set as the minimization of this variable suject to ğ“ being greater or equal than 0.5. After the optimization of the constrained problem, the optimal value of ğ“ is 0.2653.</p><pre><code class="language-julia hljs">using JuMP, PiecewiseAffineApprox, HiGHS


optimizer = optimizer_with_attributes(HiGHS.Optimizer, MOI.Silent()=&gt;true)
m = Model(optimizer)
@variable(m, x)
# Create a piecewise linear approximation to x^2 on the interval [-1, 1]
pwa = approx(x -&gt; x[1]^2, [(-1, 1)], Convex(), MILP(optimizer = optimizer, planes=5))
# Add the pwa function to the model
z = pwaffine(m, x, pwa)
# Minimize
@objective(m, Min, z)
# Check approximation/solution at x = 0.5
@constraint(m, x &gt;= 0.5)
optimize!(m);
round(value(z); digits=4)</code></pre><p>A piecewise affine approximation can be also be linked to existing variables in an existing JuMP model. In the following code, a 3D piecewise affine approximation is obtained for existing variables of a model (xvar and yvar). The approximation is constructed for a given dataset (X,z) and then linked to a JuMP model, which is optimized in the sequence.</p><pre><code class="language-julia hljs">using JuMP, PiecewiseAffineApprox, HiGHS
optimizer = optimizer_with_attributes(HiGHS.Optimizer, MOI.Silent()=&gt;true)

xg = [i for i âˆˆ -1:0.5:1]
yg = [j for j âˆˆ -1:0.5:1]
X = [repeat(xg, inner = [size(yg, 1)]) repeat(yg, outer = [size(xg, 1)])]
z = X[:, 1] .^ 2 + X[:, 2] .^ 2

np = 17

m = Model()
@variable(m, xvar)
@variable(m, yvar)
@variable(m, approx_f)

tuple_var = (xvar, yvar)

y = pwaffine(
    m,
    tuple_var,
    approx(
        FunctionEvaluations(tuple.(eachcol(X)...), z),
        Convex(),
        MILP(
            optimizer = optimizer,
            planes = np,
            strict = :outer,
            metric = :l1,
        ),
    );
    z = approx_f,
)

@objective(m, Min, y)
set_optimizer(m, optimizer)
@constraint(m, xvar == âˆš0.5)
@constraint(m, yvar == âˆš0.5)
optimize!(m)
round(value.(y))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../approximate_points/">Â« Approximate points</a><a class="docs-footer-nextpage" href="../plot_approximation/">Plot approximations Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 10 January 2025 10:26">Friday 10 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
